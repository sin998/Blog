[TOC]

# 【GAMES101-现代计算机图形学入门-闫令琪】笔记Lecture 09 Shading 3 (Texture Mapping Cont.)

# 参考资料&原文链接

[GAMES101-现代计算机图形学入门-闫令琪](https://www.bilibili.com/video/BV1X7411F744)

# 本节课目标

![image-20210925103809880](https://i.loli.net/2021/09/25/qrZug7j326dhwOR.png)

# 重心坐标(barycentric coordinates)

是为了做三角形内的插值。

## 为什么要做插值?

可以指定顶点的值。

在三角形上获得平滑的变化值。例如在三角形内部进行平滑过渡。

## 我们要插值什么?

纹理坐标，颜色，法向量...

## 如何进行插值?

重心坐标。

## 重心坐标的定义

有个三角形ABC，我不管这个三角形是在什么坐标系内表示，只要这个点在三角形的所在平面，那么都可以用这样线性表示来表示一个点，即在重心坐标下的表示：

(x,y) = αA + βB + γC 

其中 α + β + γ = 1. 如果这个不满足，那么这个点不在三角形所在的平面内。

![image-20210925105008258](https://i.loli.net/2021/09/25/gyabm15p3vAXfcM.png)

注意：**当同时满足α > 0, β  > 0, γ > 0时则说明点在三角形内。如果其中有一个为负则说明点在三角形的所在平面内。**

那么A点的重心坐标是？

![image-20210925105210027](https://i.loli.net/2021/09/25/tKn7mL9X4aSGR6T.png)

这个简单，我们可以令β和γ等于0，就得到A点的坐标是（1,0,0）。那么同理B点坐标是（0,1,0），C点坐标是（0,0,1）。

## 三角形内任意一个点的重心坐标

**可以通过面积比来求出来（利用向量叉乘的几何意义）。**现在有一个点在三角形内部，要求它的重心坐标。将这个点和三个顶点分别连线，将原本的一个三角形划分成了三个三角形，用顶点的对面的三角形来表示一个面积，例如顶点A的对面的三角形的面积是A~A~，B则是A~B~，C则是A~C~。

![image-20210925110058966](https://i.loli.net/2021/09/25/L1gIC8MisKnfAP7.png)

例如求α：α是和点A相关的，所以用点A的对面的三角形的面积A~A~比上整体的三角形的面积A+A~B~+A~C~就能求出α。其余的同理。

## 重心坐标

那么很容易就能想到一个特殊点，即这个点刚好平分每个三角形的时候（分成三等分，即每一块占1/3），那么这个时候三角形的重心坐标为(1/3,1/3,1/3)。

![image-20210925110219585](https://i.loli.net/2021/09/25/F8Y1dQMEWha5JXD.png)

## 计算重心坐标的公式

当然用三角形的面积比也是可以的，我们这里直接给出公式，这是它的简化表示：

![image-20210925110544581](https://i.loli.net/2021/09/25/HTZFnEJXqfQzdWL.png)

## 使用重心坐标

先算出点的重心坐标，在用它的属性（例如位置、纹理、颜色、深度...）来做插值：

![image-20210925110756791](https://i.loli.net/2021/09/25/Y8nWvNO2qyHisdz.png)

重心坐标在投影变换后不能保证重心坐标不发生改变。

正确的做法是：先找到像素中心点对应的三角形的位置在三维坐标中的坐标，然后在三维坐标中再把它的深度插值好放回来。

# 重心坐标应用到纹理

![image-20210925111313878](https://i.loli.net/2021/09/25/gaCUh8Pf94uEncy.png)

遍历屏幕上的每个采样点(x,y)，这个点通常是一个像素的中心点。

用三角形的重心坐标计算出(u,v)。

在对应的纹理上查询一下(u,v)的值取出这个颜色。

直接把这个颜色用到这个采样点上，就相当于把纹理上的这个点的颜色应用到屏幕上采样的这个点，完成了纹理的应用。

这么简单的应用会带来几个问题。 

## 纹理的放大

如果有一堵墙（分辨率为4K），还有一个纹理（分辨率是256*256），现在要把纹理映射到墙上，该怎么做？







































# 本文标签

`计算机图形学`、`游戏开发`、`GAMES101-现代计算机图形学入门-闫令琪`、`Unreal Engine`、`游戏开发基础`、`视频系列笔记`、`笔记`。

